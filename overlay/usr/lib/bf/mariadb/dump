#!/bin/bash

set -euo pipefail


#======================================================================================================================
# Check arguments.
#   1   Database name
#======================================================================================================================

[[ -z "${1-}" ]] && bf-error "You must provide the name of the database to export."
DATABASE=${1}

[[ -z "${2-}" ]] && bf-error "You must provide the path of the dump file."
DUMP_FILE=${2}


#======================================================================================================================
# Dump database to file.
#======================================================================================================================

mariadb-dump --add-drop-database --user=root --password=${BF_DB_ROOT_PASSWORD} --databases "${DATABASE}" > "${DUMP_FILE}"


#======================================================================================================================
# Compress file.
#======================================================================================================================

if [ "${BF_DB_BACKUP_COMPRESS_FILES}" = "1" ] ; then
    bzip2 -9 ${DUMP_FILE}
fi
